function [bending_stiffness_derivative] = GetBendingStiffnessDeriv(p_1, p_2, p_3, theta, phi,q_1,q_2,q_3)
r_b = 0.035; %[m]
C_1 = -.277; % [Nm/rad] % 2.64
C_2 = 0.5140; %TODO!!!
C_01 = 0; %TODO!!!
C_02 = 0; %TODO!!!
    
roundn = @(x,n) round(x*10^n)./10^n;
 
%   if q_1 == q_2 && q_2 == q_3
    d_M_1_bend_dq1 = 0;
    d_M_1_bend_dq2 = 0;
    d_M_1_bend_dq3 = 0;
    
    d_M_2_bend_dq1 = 0;
    d_M_2_bend_dq2 = 0;
    d_M_2_bend_dq3 = 0;
  
 
%   elseif q_2 == q_3 && q_1 > q_2
%    
%       q__1 = q_1;
%       q__2 = q_2;
%       q__3 = q_3;
%       
%       d_M_1_bend_dq1 = -(C_1*(q__2 - 2*q__1 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       d_M_1_bend_dq2 = -(C_1*(q__1 - 2*q__2 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       d_M_1_bend_dq3 = -(C_1*(q__1 + q__2 - 2*q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       
%       d_M_2_bend_dq1 = 0;
%       d_M_2_bend_dq2 = 0;
%       d_M_2_bend_dq3 = 0;
%   
%   elseif q_1 == q_2 && q_3 > q_2
%       q__1 = q_3;
%       q__2 = q_2;
%       q__3 = q_1;
%       
%       d_M_1_bend_dq3 = -(C_1*(q__2 - 2*q__1 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       d_M_1_bend_dq2 = -(C_1*(q__1 - 2*q__2 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       d_M_1_bend_dq1 = -(C_1*(q__1 + q__2 - 2*q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       
%       d_M_2_bend_dq1 = 0;
%       d_M_2_bend_dq2 = 0;
%       d_M_2_bend_dq3 = 0;
%         
%   elseif q_1 == q_3 && q_2 > q_1
%       q__1 = q_2;
%       q__2 = q_1;
%       q__3 = q_3;
%       
%       d_M_1_bend_dq2 = -(C_1*(q__2 - 2*q__1 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       d_M_1_bend_dq1 = -(C_1*(q__1 - 2*q__2 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       d_M_1_bend_dq3 = -(C_1*(q__1 + q__2 - 2*q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%       
%       d_M_2_bend_dq1 = 0;
%       d_M_2_bend_dq2 = 0;
%       d_M_2_bend_dq3 = 0;
%       
%       elseif phi < 2*pi/3 && phi >= 0
%           q__1 = q_1;
%           q__2 = q_2;
%           q__3 = q_3;
% 
%           d_M_1_bend_dq1 = (8*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2)) - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__2 - 2*q__1 + q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_1_bend_dq2 = - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__1 - 2*q__2 + q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (4*3^(1/2)*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(3^(1/2)/(q__2 - 2*q__1 + q__3) - (3^(1/2)*(q__2 - q__3))/(q__2 - 2*q__1 + q__3)^2)*(q__2 - 2*q__1 + q__3)^2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(9*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2));
%           d_M_1_bend_dq3 = - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__1 + q__2 - 2*q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) - (4*3^(1/2)*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(3^(1/2)/(q__2 - 2*q__1 + q__3) + (3^(1/2)*(q__2 - q__3))/(q__2 - 2*q__1 + q__3)^2)*(q__2 - 2*q__1 + q__3)^2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(9*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2));
% 
%       elseif phi > 2*pi/3 || phi <= - 2*pi/3
%           q__1 = q_2;
%           q__2 = q_3;
%           q__3 = q_1;
% 
%           d_M_1_bend_dq2 = (8*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2)) - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__2 - 2*q__1 + q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_1_bend_dq3 = - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__1 - 2*q__2 + q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (4*3^(1/2)*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(3^(1/2)/(q__2 - 2*q__1 + q__3) - (3^(1/2)*(q__2 - q__3))/(q__2 - 2*q__1 + q__3)^2)*(q__2 - 2*q__1 + q__3)^2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(9*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2));
%           d_M_1_bend_dq1 = - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__1 + q__2 - 2*q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) - (4*3^(1/2)*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(3^(1/2)/(q__2 - 2*q__1 + q__3) + (3^(1/2)*(q__2 - q__3))/(q__2 - 2*q__1 + q__3)^2)*(q__2 - 2*q__1 + q__3)^2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(9*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2));
% 
%       elseif phi > -2*pi/3 && phi <= 0
%           q__1 = q_3;
%           q__2 = q_1;
%           q__3 = q_2;
% 
%           d_M_1_bend_dq3 = (8*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2)) - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__2 - 2*q__1 + q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_1_bend_dq1 = - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__1 - 2*q__2 + q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (4*3^(1/2)*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(3^(1/2)/(q__2 - 2*q__1 + q__3) - (3^(1/2)*(q__2 - q__3))/(q__2 - 2*q__1 + q__3)^2)*(q__2 - 2*q__1 + q__3)^2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(9*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2));
%           d_M_1_bend_dq2 = - (2*3^(1/2)*C_1*sin(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(q__1 + q__2 - 2*q__3))/(9*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) - (4*3^(1/2)*C_1*cos(pi/3 - atan2(-3^(1/2)*(q__2 - q__3), q__2 - 2*q__1 + q__3))*(3^(1/2)/(q__2 - 2*q__1 + q__3) + (3^(1/2)*(q__2 - q__3))/(q__2 - 2*q__1 + q__3)^2)*(q__2 - 2*q__1 + q__3)^2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(9*r_b*(3*(q__2 - q__3)^2 + (q__2 - 2*q__1 + q__3)^2));
%     end
%              
%              
%       
%       if q_1 == q_2 && q_2 == q_3
%           d_M_2_bend_dq1 = 0;
%           d_M_2_bend_dq2 = 0;
%           d_M_2_bend_dq3 = 0;
%           
%       elseif q_2 == q_3 && q_1 < q_2
%           q__1 = q_1;
%           q__2 = q_2;
%           q__3 = q_3;
%           
%           d_M_2_bend_dq1 = -(C_2*(q__2 - 2*q__1 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_2_bend_dq2 = -(C_2*(q__1 - 2*q__2 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_2_bend_dq3 = -(C_2*(q__1 + q__2 - 2*q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           
%           d_M_1_bend_dq1 = 0;
%           d_M_1_bend_dq2 = 0;
%           d_M_1_bend_dq3 = 0;
%           
%       elseif q_1 == q_2 && q_3 < q_2
%           q__1 = q_3;
%           q__2 = q_2;
%           q__3 = q_1;
%           
%           d_M_2_bend_dq3 = -(C_2*(q__2 - 2*q__1 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_2_bend_dq2 = -(C_2*(q__1 - 2*q__2 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_2_bend_dq1 = -(C_2*(q__1 + q__2 - 2*q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           
%           d_M_1_bend_dq1 = 0;
%           d_M_1_bend_dq2 = 0;
%           d_M_1_bend_dq3 = 0;
%           
%       elseif q_1 == q_3 && q_2 < q_1
%           q__1 = q_2;
%           q__2 = q_1;
%           q__3 = q_3;
%           
%           d_M_2_bend_dq2 = -(C_2*(q__2 - 2*q__1 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_2_bend_dq1 = -(C_2*(q__1 - 2*q__2 + q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           d_M_2_bend_dq3 = -(C_2*(q__1 + q__2 - 2*q__3))/(3*r_b*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2));
%           
%           d_M_1_bend_dq1 = 0;
%           d_M_1_bend_dq2 = 0;
%           d_M_1_bend_dq3 = 0;
%           
%       elseif phi <= pi/3 && phi >= -pi/3
%           q__1 = q_1;
%           q__2 = q_2;
%           q__3 = q_3;
%           
%           d_M_2_bend_dq1 = (2*C_2*(q__2 - q__3)*(q__2 - 2*q__1 + q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (8*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           d_M_2_bend_dq2 = - (4*C_2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)) + (2*C_2*(q__2 - q__3)*(q__1 - 2*q__2 + q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (4*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(- 1 + 3^(1/2)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           d_M_2_bend_dq3 = (4*C_2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)) + (2*C_2*(q__2 - q__3)*(q__1 + q__2 - 2*q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) - (4*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(1 + 3^(1/2)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           
%       elseif phi >= pi/3 && phi <= pi+ 0.01
%           q__1 = q_3;
%           q__2 = q_2;
%           q__3 = q_1;
%           
%           d_M_2_bend_dq3 = (2*C_2*(q__2 - q__3)*(q__2 - 2*q__1 + q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (8*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           d_M_2_bend_dq2 = - (4*C_2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)) + (2*C_2*(q__2 - q__3)*(q__1 - 2*q__2 + q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (4*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(- 1 + 3^(1/2)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           d_M_2_bend_dq1 = (4*C_2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)) + (2*C_2*(q__2 - q__3)*(q__1 + q__2 - 2*q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) - (4*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(1 + 3^(1/2)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           
%       elseif phi <= -pi/3 && phi >= -pi
%           q__1 = q_2;
%           q__2 = q_3;
%           q__3 = q_1;
%           
%           d_M_2_bend_dq2 = (2*C_2*(q__2 - q__3)*(q__2 - 2*q__1 + q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (8*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           d_M_2_bend_dq3 = - (4*C_2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)) + (2*C_2*(q__2 - q__3)*(q__1 - 2*q__2 + q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) + (4*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(- 1 + 3^(1/2)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           d_M_2_bend_dq1 = (4*C_2*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)) + (2*C_2*(q__2 - q__3)*(q__1 + q__2 - 2*q__3))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2)) - (4*C_2*sign(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)*(1 + 3^(1/2)*1i)*(q__2 - q__3)*(q__1^2 - q__1*q__2 - q__1*q__3 + q__2^2 - q__2*q__3 + q__3^2)^(1/2))/(3*r_b*abs(2*q__1 - q__2 - q__3 + 3^(1/2)*(q__2 - q__3)*1i)^2);
%           
%       end

    bending_stiffness_derivative(1,1) = roundn(d_M_1_bend_dq1 + d_M_2_bend_dq1,2);
    bending_stiffness_derivative(2,1) = roundn(d_M_1_bend_dq2 + d_M_2_bend_dq2,2);
    bending_stiffness_derivative(3,1) = roundn(d_M_1_bend_dq3 + d_M_2_bend_dq3,2);
   
   
end

