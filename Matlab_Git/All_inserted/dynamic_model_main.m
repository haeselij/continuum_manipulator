%% Define variables
syms q_1_n q_2_n q_3_n v_1_n v_2_n v_3_n

%% Parameter list. !!After Changing parameters, run this section.!! 
D_damp_spline_ = 0;
m_ = 0.265;
g_ = -9.81;
C_ = 1;
q_0_ = 0.3014;
A_ = 0.0183*0.0183*pi;
k_ = 1108.63;
D_damp_ = 500;
r_b_ = 0.026;
k_spline_ = 10000;

%% main section
numOfIterations = 1000;
dt = 0.00005;

q_ = zeros(3, numOfIterations);
v_ = zeros(3, numOfIterations);
p_ = zeros(3, numOfIterations);

q_(:,1) = [0.3014; 0.3014; 0.3014];
v_(:,1) = [0; 0; 0];
p_(:,1) = [0.25; 0; 0];

for i = 1:numOfIterations
    q_1_dot = 1/dt*(q_1_n - q_(1,i));
    q_2_dot = 1/dt*(q_2_n - q_(2,i));
    q_3_dot = 1/dt*(q_3_n - q_(3,i));
    
    v_1_dot = 1/dt*(v_1_n - v_(1,i));
    v_2_dot = 1/dt*(v_2_n - v_(2,i));
    v_3_dot = 1/dt*(v_3_n - v_(3,i));
    
    [q_(:,i+1), v_(:,i+1)] = SolveSystem(D_damp_spline_, m_, g_, C_, q_0_, A_, k_, D_damp_, r_b_, k_spline_, q_(1,i), q_(2,i), q_(3,i), v_(1,i), v_(2,i), v_(3,i), q_1_dot, q_2_dot, q_3_dot, v_1_dot, v_2_dot, v_3_dot, p_(1,i), p_(2,i), p_(3,i));
end

%% 
function [q, v] = SolveSystem(D_damp_spline, m, g, C, q_0, A, k, D_damp, r_b, k_spline, q_1, q_2, q_3, v_1, v_2, v_3, q_1_dot, q_2_dot, q_3_dot, v_1_dot, v_2_dot, v_3_dot, p_1, p_2, p_3)
    syms q_1_n q_2_n q_3_n v_1_n v_2_n v_3_n
    
    kappa_crit = 10^(-3);
    l_bar = (q_1 + q_2 + q_3)/3;
    theta = 2/3*(sqrt(q_1^2 + q_2^2 + q_3^2 - q_1*q_2 - q_1*q_3 - q_2*q_3))/r_b;
    kappa = theta/l_bar
    phi = atan2((sqrt(3)*(q_3 - q_2)),(q_2 + q_3 - 2*q_1))
    
    if(kappa < 10^(-3))
          kappa = k_min;
           q_1 = q_1 - 0.001;
    end
    
    eqns(1,1) = m*(((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(v_2_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + v_3_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - q_1_dot^2*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (kappa*cos(kappa^2*theta)*cos(phi))/9 - (4*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (4*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (12*cos(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2) - (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)*(4*q_2 - 8*q_1 + 4*q_3))/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_1_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + q_3_dot^2*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*cos(phi))/9 + (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - q_2_dot^2*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (kappa*cos(kappa^2*theta)*cos(phi))/9 + (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + 2*q_1_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (sin(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*(q_2 - q_3)*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_1_dot*q_2_dot*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (sin(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3)*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + 2*q_2_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3))/((3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))) - ((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(q_1_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + q_2_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + q_3_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) - v_1_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - v_2_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - v_3_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + 2*q_1_dot*q_2_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + 2*q_1_dot*q_3_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + 2*q_2_dot*q_3_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3)) + ((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_3_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + q_2_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 - (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (2*sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_2_dot*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + v_3_dot*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + q_1_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 + (12*sin(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (4*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (4*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)*(4*q_2 - 8*q_1 + 4*q_3))/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_1_dot*((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - 2*q_1_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 - (cos(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*(q_2 - q_3)*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_1_dot*q_2_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3)*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_2_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3))/((3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)))) + g*m*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (C*(q_2 - 2*q_1 + q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) == (r_b*(cos(phi)*sin(theta)*((12*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^3) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2)) - cos(theta)*((6*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)^2)/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2)) + sin(phi)*sin(theta)*((2*3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (12*3^(1/2)*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^4) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))))/2 - r_b*(cos(phi)*sin(theta)*((12*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^3) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1)) - cos(theta)*((6*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)^2)/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1)) + sin(phi)*sin(theta)*((2*3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (12*3^(1/2)*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^4) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))) - (D_damp_spline*(q_1_dot/3 + q_2_dot/3 + q_3_dot/3) - k_spline*(q_0 - kappa*theta))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (r_b*(cos(phi)*sin(theta)*((12*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^3) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3)) - cos(theta)*((6*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)^2)/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3)) + sin(phi)*sin(theta)*((2*3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (12*3^(1/2)*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^4) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))))/2 + cos(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + cos(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + cos(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (3^(1/2)*r_b*(cos(theta)*((6*3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)^3)/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4) - (2*3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2) + (3^(1/2)*cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2)) - sin(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((12*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^3) + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + cos(phi)*sin(theta)*((2*3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (12*3^(1/2)*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^4) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))))/2 + (3^(1/2)*r_b*(cos(theta)*((6*3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)^3)/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4) - (2*3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2) + (3^(1/2)*cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3)) - sin(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((12*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^3) + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + cos(phi)*sin(theta)*((2*3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (12*3^(1/2)*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)^4) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))))/2 + sin(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + sin(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + sin(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)));
    eqns(1,2) = m*(((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(v_2_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + v_3_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - q_1_dot^2*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (kappa*cos(kappa^2*theta)*cos(phi))/9 - (4*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (4*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (12*cos(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2) - (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)*(4*q_2 - 8*q_1 + 4*q_3))/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_1_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + q_3_dot^2*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*cos(phi))/9 + (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - q_2_dot^2*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (kappa*cos(kappa^2*theta)*cos(phi))/9 + (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + 2*q_1_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (sin(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*(q_2 - q_3)*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_1_dot*q_2_dot*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (sin(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3)*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + 2*q_2_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3))/((3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))) + ((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(q_3_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + q_2_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 - (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (2*sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_2_dot*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + v_3_dot*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + q_1_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 + (12*sin(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (4*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (4*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)*(4*q_2 - 8*q_1 + 4*q_3))/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_1_dot*((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - 2*q_1_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 - (cos(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*(q_2 - q_3)*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_1_dot*q_2_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3)*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_2_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3))/((3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))) - ((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(q_1_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + q_2_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + q_3_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) - v_1_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - v_2_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - v_3_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + 2*q_1_dot*q_2_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + 2*q_1_dot*q_3_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + 2*q_2_dot*q_3_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3))) + g*m*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (C*(q_1 - 2*q_2 + q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) == (r_b*(sin(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(theta)*((sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2)) + cos(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))))/2 - r_b*(sin(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(theta)*((sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1)) + cos(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))) - (D_damp_spline*(q_1_dot/3 + q_2_dot/3 + q_3_dot/3) - k_spline*(q_0 - kappa*theta))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (r_b*(sin(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(theta)*((sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3)) + cos(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))))/2 + cos(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + cos(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + cos(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (3^(1/2)*r_b*(cos(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + cos(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - sin(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))))/2 + (3^(1/2)*r_b*(cos(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + cos(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - sin(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))))/2 - cos(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - cos(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - cos(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + sin(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + sin(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + sin(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)));
    eqns(1,3) = m*(((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(v_2_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + v_3_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - q_1_dot^2*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (kappa*cos(kappa^2*theta)*cos(phi))/9 - (4*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (4*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (12*cos(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2) - (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)*(4*q_2 - 8*q_1 + 4*q_3))/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_1_dot*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (9*r_b*(q_2 - q_3)^2*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^3*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + q_3_dot^2*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*cos(phi))/9 + (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - q_2_dot^2*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (kappa*cos(kappa^2*theta)*cos(phi))/9 + (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + 2*q_1_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (sin(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*(q_2 - q_3)*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_1_dot*q_2_dot*(((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) + (sin(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3)*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*sin(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + 2*q_2_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*cos(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*cos(phi) + (2*theta*sin(kappa^2*theta)*cos(phi))/kappa) - (kappa*cos(kappa^2*theta)*cos(phi))/9 - ((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (sin(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3))/((3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (sin(kappa^2*theta)*sin(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*cos(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (cos(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))) + ((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(q_3_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (2*sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) + (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + q_2_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 - (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3)^2 - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^3)*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (2*sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (((2*3^(1/2))/(q_2 - 2*q_1 + q_3) - (2*3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)^2*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_2_dot*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) - (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 - (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + v_3_dot*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + q_1_dot^2*(((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) + (kappa*cos(kappa^2*theta)*sin(phi))/9 + (12*sin(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2) - (2*kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (4*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (4*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*cos(phi)*(cos(kappa^2*theta) - 1)*(q_2 - q_3)*(4*q_2 - 8*q_1 + 4*q_3))/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) + v_1_dot*((3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (9*3^(1/2)*r_b*(q_2 - q_3)^3*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)^4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - 2*q_1_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 - (cos(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*(q_2 - q_3)*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_1_dot*q_2_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*((2*3^(1/2))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3)*(4*q_1 - 8*q_2 + 4*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa - (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(kappa^2*theta)*cos(phi)*(q_2 - q_3))/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*(q_2 - q_3)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) - (2*3^(1/2)*sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - q_3)*(q_2 - 2*q_1 + q_3)^2)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2)) - 2*q_2_dot*q_3_dot*(((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*sin(phi)*(cos(kappa^2*theta) - 1))/kappa^3 - kappa*theta^2*cos(kappa^2*theta)*sin(phi) + (2*theta*sin(kappa^2*theta)*sin(phi))/kappa) - ((sin(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*sin(phi))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (kappa*cos(kappa^2*theta)*sin(phi))/9 + (cos(phi)*(cos(kappa^2*theta) - 1)*(((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(2*q_2 - 4*q_1 + 2*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (2*3^(1/2)*(q_2 - q_3))/((3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2*(4*q_1 + 4*q_2 - 8*q_3))/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))/kappa + (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) - (sin(kappa^2*theta)*cos(phi)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^2)/(9*(q_2 - q_3)^2 + 3*(q_2 - 2*q_1 + q_3)^2) + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 + (kappa*theta*cos(kappa^2*theta)*sin(phi)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - ((3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + ((3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*((cos(phi)*(cos(kappa^2*theta) - 1))/kappa^2 + theta*sin(kappa^2*theta)*cos(phi))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(q_2 - 2*q_1 + q_3)^2)/(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2) + (sin(phi)*(cos(kappa^2*theta) - 1)*(3^(1/2)/(q_2 - 2*q_1 + q_3) + (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(3^(1/2)/(q_2 - 2*q_1 + q_3) - (3^(1/2)*(q_2 - q_3))/(q_2 - 2*q_1 + q_3)^2)*(q_2 - 2*q_1 + q_3)^4)/(kappa*(3*(q_2 - q_3)^2 + (q_2 - 2*q_1 + q_3)^2)^2))) - ((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)))*(q_1_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_2 - 4*q_1 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_2 - 2*q_1 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + q_2_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 - 4*q_2 + 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 - 2*q_2 + q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + q_3_dot^2*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*(2/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) + (2*q_1 + 2*q_2 - 4*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (q_1 + q_2 - 2*q_3)^2/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))^2*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) + (kappa*sin(kappa^2*theta))/9 - (2*kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) - v_1_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - 2*q_1 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - v_2_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 - 2*q_2 + q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - v_3_dot*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + 2*q_1_dot*q_2_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 - 2*q_2 + q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + 2*q_1_dot*q_3_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_2 - 2*q_1 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_2 - 2*q_1 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3) + 2*q_2_dot*q_3_dot*((sin(kappa^2*theta)/kappa^2 - theta*cos(kappa^2*theta))*((4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^3) - 1/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - ((q_1 + q_2 - 2*q_3)*(q_1 - 2*q_2 + q_3))/(2*r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + (kappa*sin(kappa^2*theta))/9 + ((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*((2*theta*cos(kappa^2*theta))/kappa - (2*sin(kappa^2*theta))/kappa^3 + kappa*theta^2*sin(kappa^2*theta)) - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 + q_2 - 2*q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3 - (kappa*theta*sin(kappa^2*theta)*((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(r_b*(q_1 + q_2 + q_3)^2) + (q_1 - 2*q_2 + q_3)/(r_b*(q_1 + q_2 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))))/3))) + g*m*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (C*(q_1 + q_2 - 2*q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) == r_b*(sin(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(theta)*((sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)) - (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1)) + cos(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))) - (D_damp_spline*(q_1_dot/3 + q_2_dot/3 + q_3_dot/3) - k_spline*(q_0 - kappa*theta))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (r_b*(sin(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(theta)*((sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)) - (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2)) + cos(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))))/2 - (r_b*(sin(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(theta)*((sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)) - (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3)) + cos(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))))/2 + cos(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + cos(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + cos(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*q_1*q_2 + 2*q_1*q_3 + 2*q_2*q_3 - 2*q_1^2 - 2*q_2^2 - 2*q_3^2) + (3*r_b*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - (3^(1/2)*r_b*(cos(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + sin(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))))/2 + (3^(1/2)*r_b*(cos(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) - cos(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)) + (3^(1/2)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)^2) - (3^(1/2)*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2*(q_2 - 2*q_1 + q_3)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))) + sin(phi)*sin(theta)*((((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^2 - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3))/(3*r_b*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)))*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))))/2 - cos(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - cos(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) - cos(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + sin(phi)*sin(theta)*(A*p_1 - D_damp*q_1_dot + k*(q_0 - q_1))*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + sin(phi)*sin(theta)*(A*p_2 - D_damp*q_2_dot + k*(q_0 - q_2))*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2))) + sin(phi)*sin(theta)*(A*p_3 - D_damp*q_3_dot + k*(q_0 - q_3))*((3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)^2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) - (3^(1/2)*sin((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b))*(q_2 - q_3)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(2*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1*q_2 + q_1*q_3 + q_2*q_3 - q_1^2 - q_2^2 - q_3^2)) + (3*3^(1/2)*r_b*((6*q_2 - 6*q_3)/(q_2 - 2*q_1 + q_3)^2 + (6*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^3)*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(3/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2)) + (3*3^(1/2)*r_b*(q_2 - q_3)*(cos((2*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(1/2))/(3*r_b)) - 1)*(q_1 + q_2 - 2*q_3)*(q_1/3 + q_2/3 + q_3/3))/(4*((3*(q_2 - q_3)^2)/(q_2 - 2*q_1 + q_3)^2 + 1)^(1/2)*(q_2 - 2*q_1 + q_3)*(q_1^2 - q_1*q_3 - q_2*q_3 - q_1*q_2 + q_2^2 + q_3^2)^(3/2)));
    eqns(1,4) = q_1_dot == v_1;
    eqns(1,5) = q_2_dot == v_2;
    eqns(1,6) = q_3_dot == v_3;

    vars = [q_1_n q_2_n q_3_n v_1_n v_2_n v_3_n];
    initGuess = [0.3014; 0.3014; 0.3014; 0; 0; 0];

    solution = vpasolve(eqns, vars, initGuess);

    q = [solution.q_1_n; solution.q_2_n; solution.q_2_n];
    v = [solution.v_1_n; solution.v_2_n; solution.v_3_n]; 
end
